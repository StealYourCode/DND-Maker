<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>D&D Character Creator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <h1>New character</h1>

    <div class="progress-bar">
      <div class="progress-bar-fill" id="progressFill"></div>
      <!-- Step markers below the progress bar -->
      <div class="progress-step" style="left: 0%;">Races</div>
      <div class="progress-step" style="left: 25%;">Classes</div>
      <div class="progress-step" style="left: 50%;">Background</div>
      <div class="progress-step" style="left: 75%;">Starting Item</div>
      <div class="progress-step" style="left: 100%;">Finish</div>
    </div>

    <div class="buttonBox">
      

    <div id="cardContainer" class="card-container"></div>

    <button onclick="loadRaces()">Start</button>
    <button onclick="next(1)">Progress</button>
    <button onclick="backHome()">Return to the main menu</button>
    </div>

  

    <script>
      async function loadRaces() {
        try {
          const response = await fetch('/get_races');
          if (!response.ok) throw new Error("Network response was not ok");
          const races = await response.json();

          const cardContainer = document.getElementById('cardContainer'); // Ensure this div exists in your HTML

          // Clear any existing cards in case the function is called multiple times
          cardContainer.innerHTML = '';

          races.forEach(race => {
            // Create a card div
            const card = document.createElement('div');
            card.className = 'race-card';

            // Create an image element
            const img = document.createElement('img');
            img.src = race.image; // Assuming 'image' is the correct path key
            img.alt = race.name || "Race Image"; // Use race name or a default alt text
            img.className = 'race-image';

            // Optionally, add other details (e.g., race name)
            const name = document.createElement('h3');
            name.textContent = race.name || 'Unnamed Race';
            name.className = 'race-name';

            // Append image and other details to the card
            card.appendChild(img);
            card.appendChild(name);

            // Append card to the container
            cardContainer.appendChild(card);
        })

        } catch (error) {
          console.error("There was a problem with the races fetch operation:", error);
        }
      }


      const progressBarFill = document.getElementById('progressFill');

      function updateProgressBar(stepIndex) {
        const stepPercentage = 100 / 5; // Total 5 steps
        progressBarFill.style.width = `${(stepIndex + 1) * stepPercentage}%`;
      }

      function next(stepindex) {
        updateProgressBar(stepindex);
      }

      function backHome() {
        if (window.confirm("Are you sure you want to go back, your data won't be save ?")){
          location.href = "/";
        }
      }
    </script>


</body>
</html>
